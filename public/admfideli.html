<script>
  // Funções para acessar e gerenciar os usuários no localStorage
  function getUsers() {
      return JSON.parse(localStorage.getItem('users')) || [];
  }

  function saveUsers(users) {
      localStorage.setItem('users', JSON.stringify(users));
  }

  // Função para adicionar novo cliente
  function addUser(user) {
      const users = getUsers();
      users.push(user);
      saveUsers(users);
      renderUserList();
  }

  // Função para excluir usuário pelo ID
  function deleteUser(userId) {
      const users = getUsers();
      const filteredUsers = users.filter(user => user.id !== userId); // Filtra usuários, excluindo o com o ID fornecido
      saveUsers(filteredUsers); // Salva a nova lista no localStorage
      renderUserList(); // Atualiza a interface
  }

  // Função para renderizar a lista de usuários
  function renderUserList() {
      const users = getUsers();
      const userListContainer = document.getElementById('user-list');
      userListContainer.innerHTML = ''; // Limpa a lista

      if (users.length === 0) {
          userListContainer.innerHTML = '<p>Nenhum usuário cadastrado.</p>';
          return;
      }

      users.forEach(user => {
          const userCard = document.createElement('div');
          userCard.classList.add('user-card');
          userCard.innerHTML = `
              <h3>${user.name} <span>(ID: ${user.id})</span></h3>
              <ul>
                  ${user.travels.map((travel, index) => `
                      <li>
                          ${travel} 
                          <button class="danger" onclick="deleteTravel('${user.id}', ${index})">Excluir</button>
                      </li>
                  `).join('')}
              </ul>
              <div style="margin-top: 10px;">
                  <button onclick="sendTravelToUser('${user.id}')">Enviar Viagem</button>
                  <button class="danger" onclick="deleteUser('${user.id}')">Excluir Usuário</button>
              </div>
          `;
          userListContainer.appendChild(userCard);
      });
  }

  // Listener para o formulário de criação de cliente
  document.getElementById('create-user-form').addEventListener('submit', function(event) {
      event.preventDefault();
      const name = document.getElementById('name').value;
      const cpf = document.getElementById('cpf').value;
      const email = document.getElementById('email').value;
      const phone = document.getElementById('phone').value;

      const newUser = {
          id: Date.now().toString(), // Gera um ID único
          name,
          cpf,
          email,
          phone,
          travels: [] // Inicializa sem viagens
      };

      addUser(newUser);

      // Limpa o formulário
      event.target.reset();
  });

  // Inicializa a lista de usuários ao carregar a página
  renderUserList();
</script>
